<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Admin – M&D Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { background:#0f0f0f; color:#fff; font-family:Arial; padding:20px }
h1 { color:#00f0ff }
input, button { padding:6px; margin:4px }
table { width:100%; border-collapse:collapse }
th,td { border:1px solid #333; padding:6px }
button { cursor:pointer; font-weight:bold }
</style>
</head>
<body>

<h1>Admin M&D Store</h1>

<table id="tabla"></table>

<h2>Nuevo producto</h2>
<input id="name" placeholder="Nombre">
<input id="price" placeholder="Precio" type="number">
<input id="stock" placeholder="Stock" type="number">
<input id="category" placeholder="Categoría">
<input id="img" placeholder="Imagen (ruta)">
<button onclick="add()">Agregar</button>

<script>
let productos = [];

fetch("products.json")
.then(r=>r.json())
.then(d=>{ productos=d; render(); });

function render(){
  const t=document.getElementById("tabla");
  t.innerHTML=`
  <tr><th>Nombre</th><th>Precio</th><th>Stock</th><th>Cat</th><th>Img</th><th></th></tr>`;
  productos.forEach((p,i)=>{
    t.innerHTML+=`
    <tr>
      <td><input value="${p.name}" onchange="u(${i},'name',this.value)"></td>
      <td><input type="number" value="${p.price}" onchange="u(${i},'price',this.value)"></td>
      <td><input type="number" value="${p.stock}" onchange="u(${i},'stock',this.value)"></td>
      <td><input value="${p.category}" onchange="u(${i},'category',this.value)"></td>
      <td><input value="${p.img}" onchange="u(${i},'img',this.value)"></td>
      <td><button onclick="del(${i})">X</button></td>
    </tr>`;
  });
}

function u(i,f,v){ productos[i][f]=v; save(); }
function del(i){ productos.splice(i,1); save(); }

function add(){
  productos.push({
    id: Date.now(),
    name:name.value,
    price:+price.value,
    stock:+stock.value,
    category:category.value,
    img:img.value
  });
  save();
}

function save(){
  const blob=new Blob([JSON.stringify(productos,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="products.json";
  a.click();
}
</script>

</body>
</html>
